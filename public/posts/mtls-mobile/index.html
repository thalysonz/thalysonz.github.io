<!doctype html><html><head lang=en><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Exploring mTLS in Mobile Applications - thalysonz</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="mtls in mobile real scenario"><meta property="og:image" content><meta property="og:url" content="http://localhost:1313/posts/mtls-mobile/"><meta property="og:site_name" content="thalysonz"><meta property="og:title" content="Exploring mTLS in Mobile Applications"><meta property="og:description" content="mtls in mobile real scenario"><meta property="og:locale" content="pt_BR"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-26T00:00:00+00:00"><meta property="article:tag" content="Web"><meta property="article:tag" content="Mobile"><meta property="article:tag" content="Bug-Bounty"><meta property="article:tag" content="En"><meta name=twitter:card content="summary"><meta name=twitter:title content="Exploring mTLS in Mobile Applications"><meta name=twitter:description content="mtls in mobile real scenario"><script src=http://localhost:1313/js/feather.min.js></script><link href=http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><link id=darkModeStyle rel=stylesheet type=text/css href=http://localhost:1313/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=content><header><div class=main><a href=http://localhost:1313/>thalysonz</a></div><nav><a href=/>Home</a>
<a href=/posts>Posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Exploring mTLS in Mobile Applications</h1><div class=meta>Posted on Jun 26, 2024</div></div><section class=body><h2 id=exploring-mtls-in-bug-bounty-programs>Exploring mTLS in Bug Bounty Programs</h2><p>Today, I will present a case study on mTLS that I conducted in a private bug bounty program.</p><p><strong>mTLS</strong> (Mutual TLS) is a method of mutual authentication that ensures both parties in a network connection are who they claim to be. In an mTLS connection, the server verifies the client&rsquo;s certificate, and the client verifies the server&rsquo;s certificate. If a proxy like Burp Suite were used in this connection, the server would reject the connection.</p><h3 id=what-is-mtls>What is mTLS?</h3><p>Mutual TLS (mTLS) is a security protocol used in network communications to provide an enhanced level of security. In a standard TLS setup, only the server is authenticated, while the client remains unauthenticated. This means that while the client can trust the server, the reverse isn&rsquo;t necessarily true.</p><p>In contrast, mTLS adds an extra layer of security by requiring both the client and the server to authenticate themselves to each other before establishing a secure connection. This is achieved through the use of digital certificates on both ends. When a client attempts to connect to a server using mTLS, the following steps typically occur:</p><ol><li>The client presents its certificate to the server.</li><li>The server verifies the client&rsquo;s certificate.</li><li>The server presents its certificate to the client.</li><li>The client verifies the server&rsquo;s certificate.</li></ol><h3 id=how-does-the-client-certificate-verification-flow-work>How Does the Client Certificate Verification Flow Work?</h3><p>In the case of this application, a request containing a Certificate Signing Request (CSR) certificate was sent to the server. The server&rsquo;s response was a CA (Certificate Authority) certificate signed by the company.</p><h3 id=certificate-signing-request-csr-in-mtls>Certificate Signing Request (CSR) in mTLS</h3><p>A crucial component in the mTLS process is the Certificate Signing Request (CSR). Let&rsquo;s break down what a CSR is and its role in mTLS:</p><ul><li>A CSR is one of the initial steps in obtaining an SSL/TLS certificate.</li><li>It&rsquo;s generated on the server where you plan to install the certificate.</li><li>The CSR contains essential information such as the common name, organization, and country.</li><li>It also includes the public key that will be part of your certificate.</li><li>The CSR is signed with the corresponding private key.</li></ul><h3 id=pkcs-12-bundling-cryptographic-objects>PKCS #12: Bundling Cryptographic Objects</h3><p>PKCS #12 is an archive file format used for storing multiple cryptography objects in a single file. It&rsquo;s commonly used to:</p><ul><li>Bundle a private key with its X.509 certificate</li><li>Bundle all members of a chain of trust</li></ul><p>This format plays a crucial role in managing the various certificates and keys used in mTLS.</p><h3 id=app>APP</h3><h4 id=csr-request-and-ca-response>CSR Request and CA Response</h4><p><img src=https://cdn-images-1.medium.com/max/2400/1*PHXBzazlYOZrqlqAGM6SmQ.png alt="CSR Request and CA Response"></p><p>In the image above, we have a section of the application code responsible for creating the CSR certificate that will be sent to the server.</p><h4 id=hooking-process>Hooking Process</h4><p>Using Frida, I converted my keys (public and private) to the format expected by the <code>generateCertificateSigningRequest(args)</code>.</p><p><img src=https://cdn-images-1.medium.com/max/2400/1*yTJH8I0LLP1kXtQOF-Jakg.png alt="Hooking Process"></p><p>We can then hook the generateCertificateSigningRequest(args) function and alter the public and private keys used in the CSR creation process. Now the application will send the CSR certificate containing the new keys and generate a CA that we can use to create a pkcs12 file and import it into Burp Suite.</p><p><img src=https://cdn-images-1.medium.com/max/2400/1*ME0HQovHdDGk2zLLUCOqlQ.png alt="Hooking Process">
<img src=https://cdn-images-1.medium.com/max/2400/1*lkQdRVt6AjmeRlk4-UEoHQ.png alt="Hooking Process"></p><p><img src=https://cdn-images-1.medium.com/max/1600/1*LHu7Psz_2UZLdFC8BgO3Zw.png alt=CAcreated></p><h4 id=pkcs12-import-in-burp-suite>PKCS#12 Import in Burp Suite</h4><p><img src=https://cdn-images-1.medium.com/max/2400/1*J6azIAinTn-sqqTSvI40JQ.png alt="PKCS#12 Import in Burp Suite"></p><p><img src=https://cdn-images-1.medium.com/max/2400/1*5aQ2OTRY5QNC_nLKody3ow.png alt></p><h4 id=conclusion>Conclusion</h4><p>Mutual TLS provides a robust method of ensuring secure and authenticated communication between clients and servers. In the context of a bug bounty program, understanding and exploiting mTLS can be crucial for identifying potential security flaws and vulnerabilities.</p><p>For more detailed information on mTLS and related topics, you can refer to the following resources:</p><ul><li><a href=https://www.cloudflare.com/pt-br/learning/access-management/what-is-mutual-tls/>Cloudflare: What is Mutual TLS?</a></li><li><a href=https://www.globalsign.com/pt-br/blog/what-is-a-certificate-signing-request-csr>GlobalSign: What is a Certificate Signing Request (CSR)?</a></li><li><a href=https://www.hostinger.com.br/tutoriais/o-que-e-ssl-tls-https>Hostinger: What is SSL/TLS?</a></li></ul><p>Happy securing!</p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/web>web</a></li><li><a href=/tags/mobile>mobile</a></li><li><a href=/tags/bug-bounty>bug-bounty</a></li><li><a href=/tags/en>en</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/thalysonz rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/Thalysonsousx rel=me title=Twitter><i data-feather=twitter></i></a>
<a class=border></a></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>