<!doctype html><html><head lang=en><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Race Condition: Some Real Cases - thalysonz</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="real scenarios that I reported in 2023 in bug bounty programs"><meta property="og:image" content><meta property="og:url" content="http://localhost:1313/posts/race-condition-real-cases/"><meta property="og:site_name" content="thalysonz"><meta property="og:title" content="Race Condition: Some Real Cases"><meta property="og:description" content="real scenarios that I reported in 2023 in bug bounty programs"><meta property="og:locale" content="pt_BR"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-25T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-25T00:00:00+00:00"><meta property="article:tag" content="Web"><meta property="article:tag" content="Race-Condition"><meta property="article:tag" content="Bug-Bounty"><meta property="article:tag" content="En"><meta name=twitter:card content="summary"><meta name=twitter:title content="Race Condition: Some Real Cases"><meta name=twitter:description content="real scenarios that I reported in 2023 in bug bounty programs"><script src=http://localhost:1313/js/feather.min.js></script><link href=http://localhost:1313/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet><link rel=stylesheet type=text/css media=screen href=http://localhost:1313/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css><link id=darkModeStyle rel=stylesheet type=text/css href=http://localhost:1313/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css><script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type=text/x-mathjax-config>
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script></head><body><div class=content><header><div class=main><a href=http://localhost:1313/>thalysonz</a></div><nav><a href=/>Home</a>
<a href=/posts>Posts</a>
<a href=/about>About</a>
<a href=/tags>Tags</a></nav></header><main><article><div class=title><h1 class=title>Race Condition: Some Real Cases</h1><div class=meta>Posted on May 25, 2024</div></div><section class=body><h2 id=understanding-race-conditions>Understanding Race Conditions</h2><p>Race conditions are a prevalent vulnerability closely linked to business logic flaws in web applications. They arise when websites process concurrent requests without proper safeguards, leading to multiple threads interacting with the same data simultaneously. This interaction can cause &ldquo;collisions,&rdquo; resulting in unintended application behavior. Malicious actors exploit these race conditions by carefully timing their requests to create intentional collisions for nefarious purposes.</p><p>For those interested in diving deeper into race conditions or practicing in controlled environments, numerous online labs and resources are available.</p><p>-> <a href="https://portswigger.net/web-security/race-conditions?source=post_page-----598b260ab3f0--------------------------------">Portswigger Race Condition</a></p><h2 id=introduction-to-real-world-scenarios>Introduction to Real-World Scenarios</h2><p>In this post, I&rsquo;ll share some race condition scenarios I encountered during bug bounty hunting in 2023 and 2024. These findings were inspired by the insightful research of <a href=https://twitter.com/albinowax>@albinowax</a>.</p><h2 id=scenario-1-exploiting-refund-mechanisms>Scenario 1: Exploiting Refund Mechanisms</h2><h3 id=the-vulnerability>The Vulnerability</h3><p>This scenario represents the most critical vulnerability I discovered, allowing for the exploitation of the application&rsquo;s refund feature.</p><h3 id=the-process>The Process</h3><ol><li><p><strong>Service Subscription A</strong>: Users could choose between two plans:</p><ul><li>Plan A: R$ 49.00</li><li>Plan B: R$ 450.00</li></ul><p><img src=https://miro.medium.com/v2/resize:fit:792/format:webp/1*n0YtGsG1EQmXBCHTlsksZw.png alt></p></li><li><p><strong>Refund Policy</strong>: After subscribing, customers could request a refund for the full amount paid.</p></li><li><p><strong>Exploitation Method</strong>:</p><ul><li>I used the turbo intruder tool, selecting the race condition option.</li><li>Multiple cancellation requests were sent simultaneously.</li><li>Several requests returned a 200 status, indicating successful processing.</li></ul></li></ol><ul><li><strong>Plan A</strong>
<img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RW1BVcjB85vPGup8HxGZHw.png alt></li></ul><p><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yBGcjXVdquA3hX7kAwb2lQ.png alt></p><ul><li><strong>Plan B</strong>
<img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y7ES0NRfvS2BE8M5Gbxtsw.png alt>
<img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbkzJFoT9VR3yneBgAIA1g.png alt></li></ul><h3 id=the-result>The Result</h3><ul><li>Initial deposit: R$ 50.00</li><li>Service charge: R$ 49.00</li><li>Outcome: Multiple refund deposits were processed</li><li>Final balance: R$ 981.00</li></ul><ol><li><strong>Plan A</strong></li></ol><p><img src=https://miro.medium.com/v2/resize:fit:550/format:webp/1*Bb13lPMc2gFmbQILlZKSIQ.png alt=planA1></p><p><img src=https://miro.medium.com/v2/resize:fit:584/format:webp/1*4R5Z25PQEBTWzOnOeTlV0A.png alt=planA2></p><ol><li><strong>Plan B</strong></li></ol><p><img src=https://miro.medium.com/v2/resize:fit:608/format:webp/1*jc9QbolLh8oCoDLd4w9Ciw.png alt=planB></p><h2 id=scenario-2-bypassing-deposit-limits>Scenario 2: Bypassing Deposit Limits</h2><h3 id=the-context>The Context</h3><p>This case, while not rewarded due to its occurrence in a sandbox environment, provides valuable insights into potential exploits.</p><h3 id=the-vulnerability-1>The Vulnerability</h3><ul><li>The application had a daily deposit limit of $1,000.</li><li>Using the turbo intruder, I successfully bypassed this limit.</li></ul><p><img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FV8SdB8yhwU_tvXGqa2yyw.png alt>
<img src=https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGsbwuSQ5v91UNSES9tHHg.png alt></p><h3 id=demonstration>Demonstration</h3><p>I replicated this bypass on multiple accounts, consistently circumventing the daily limit. Even when the application displayed a message indicating the limit had been reached, the exploit allowed for additional deposits.</p><p><img src=https://miro.medium.com/v2/resize:fit:804/format:webp/1*MSjsGV_KzLDgs1-sb-svHA.png alt></p><h2 id=conclusion>Conclusion</h2><p>These scenarios highlight the critical importance of proper concurrency handling in web applications. Race conditions, when left unaddressed, can lead to significant security breaches and financial exploits. Developers and security teams must prioritize robust safeguards against these vulnerabilities to ensure the integrity of their systems.</p><h2 id=race-condition-bountys>Race Condition Bountys</h2><p><img src=https://miro.medium.com/v2/resize:fit:1134/format:webp/1*05rAAVNpoPrNQkp5GGk68A.png alt></p></section><div class=post-tags><nav class="nav tags"><ul class=tags><li><a href=/tags/web>web</a></li><li><a href=/tags/race-condition>race-condition</a></li><li><a href=/tags/bug-bounty>bug-bounty</a></li><li><a href=/tags/en>en</a></li></ul></nav></div></article></main><footer><div style=display:flex><a class=soc href=https://github.com/thalysonz rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://twitter.com/Thalysonsousx rel=me title=Twitter><i data-feather=twitter></i></a>
<a class=border></a></div><div class=footer-info>2024 <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></footer><script>feather.replace()</script></div></body></html>